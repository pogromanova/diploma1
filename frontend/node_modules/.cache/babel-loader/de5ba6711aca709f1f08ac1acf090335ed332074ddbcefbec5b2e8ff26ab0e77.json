{"ast":null,"code":"import _slicedToArray from\"/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from\"./styles.module.css\";import{Icons,Button}from\"..\";import DefaultImage from\"../../images/avatar-icon.png\";import{useEffect,useRef,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AvatarPopup=function AvatarPopup(_ref){var onSubmit=_ref.onSubmit,onClose=_ref.onClose,_ref$fileSize=_ref.fileSize,fileSize=_ref$fileSize===void 0?5:_ref$fileSize,_ref$fileTypes=_ref.fileTypes,fileTypes=_ref$fileTypes===void 0?[\"jpg\",\"png\"]:_ref$fileTypes,onChange=_ref.onChange,avatar=_ref.avatar;var _useState=useState(avatar),_useState2=_slicedToArray(_useState,2),currentFile=_useState2[0],setCurrentFile=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var fileInput=useRef(null);useEffect(function(){if(avatar){setCurrentFile(avatar);}},[avatar]);var getBase64=function getBase64(file){var reader=new FileReader();var fileNameArr=file.name.split(\".\");var format=fileNameArr[fileNameArr.length-1];if(fileSize&&file.size/(1024*1024)>fileSize){return setError(\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0444\\u0430\\u0439\\u043B \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440\\u043E\\u043C \\u043D\\u0435 \\u0431\\u043E\\u043B\\u0435\\u0435 \".concat(fileSize,\"\\u041C\\u0431\"));}if(fileTypes&&!fileTypes.includes(format)){return setError(\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0444\\u0430\\u0439\\u043B \\u043E\\u0434\\u043D\\u043E\\u0433\\u043E \\u0438\\u0437 \\u0442\\u0438\\u043F\\u043E\\u0432: \".concat(fileTypes.join(\", \")));}reader.readAsDataURL(file);reader.onload=function(){setCurrentFile(reader.result);onChange(reader.result);};reader.onerror=function(error){console.log(\"Error: \",error);};};return/*#__PURE__*/_jsx(\"div\",{className:styles.popup,onClick:function onClick(e){if(e.target===e.currentTarget){onClose===null||onClose===void 0?void 0:onClose();}},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.popup__content,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.popup__close,onClick:onClose,children:/*#__PURE__*/_jsx(Icons.PopupClose,{})}),/*#__PURE__*/_jsx(\"h3\",{className:styles.popup__title,children:\"\\u0410\\u0432\\u0430\\u0442\\u0430\\u0440\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.image,style:{backgroundImage:\"url(\".concat(currentFile||DefaultImage,\")\")},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.imageOverlay,children:[/*#__PURE__*/_jsx(Button,{className:styles.button_overlay,clickHandler:function clickHandler(_){fileInput.current.click();},children:/*#__PURE__*/_jsx(Icons.AddAvatarIcon,{})}),currentFile&&/*#__PURE__*/_jsx(Button,{className:styles.button_overlay,clickHandler:function clickHandler(){setCurrentFile(null);onChange(null);fileInput.current.value=\"\";},children:/*#__PURE__*/_jsx(Icons.DeleteAvatarIcon,{})})]})}),/*#__PURE__*/_jsx(\"input\",{className:styles.fileInput,type:\"file\",ref:fileInput,onChange:function onChange(e){setError(\"\");var file=e.target.files[0];getBase64(file);}}),error&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:error}),/*#__PURE__*/_jsx(\"p\",{className:styles.info,children:\"\\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \".concat(fileTypes.join(\"/\"),\", \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440 \\u0434\\u043E \").concat(fileSize,\"\\u043C\\u0431\")}),/*#__PURE__*/_jsx(Button,{className:styles.popup__button,clickHandler:onSubmit,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})});};","map":{"version":3,"names":["styles","Icons","Button","DefaultImage","useEffect","useRef","useState","AvatarPopup","onSubmit","onClose","fileSize","fileTypes","onChange","avatar","currentFile","setCurrentFile","error","setError","fileInput","getBase64","file","reader","FileReader","fileNameArr","name","split","format","length","size","includes","join","readAsDataURL","onload","result","onerror","console","log","popup","e","target","currentTarget","popup__content","popup__close","popup__title","image","backgroundImage","imageOverlay","button_overlay","_","current","click","value","files","info","popup__button"],"sources":["/app/src/components/avatar-popup/index.js"],"sourcesContent":["import styles from \"./styles.module.css\";\nimport { Icons, Button } from \"..\";\nimport DefaultImage from \"../../images/avatar-icon.png\";\nimport { useEffect, useRef, useState } from \"react\";\n\nexport const AvatarPopup = ({\n  onSubmit,\n  onClose,\n  fileSize = 5,\n  fileTypes = [\"jpg\", \"png\"],\n  onChange,\n  avatar,\n}) => {\n  const [currentFile, setCurrentFile] = useState(avatar);\n  const [error, setError] = useState(\"\");\n  const fileInput = useRef(null);\n\n  useEffect(() => {\n    if (avatar) {\n      setCurrentFile(avatar);\n    }\n  }, [avatar]);\n\n  const getBase64 = (file) => {\n    const reader = new FileReader();\n\n    const fileNameArr = file.name.split(\".\");\n    const format = fileNameArr[fileNameArr.length - 1];\n\n    if (fileSize && file.size / (1024 * 1024) > fileSize) {\n      return setError(`Загрузите файл размером не более ${fileSize}Мб`);\n    }\n    if (fileTypes && !fileTypes.includes(format)) {\n      return setError(\n        `Загрузите файл одного из типов: ${fileTypes.join(\", \")}`\n      );\n    }\n    reader.readAsDataURL(file);\n    reader.onload = function () {\n      setCurrentFile(reader.result);\n      onChange(reader.result);\n    };\n    reader.onerror = function (error) {\n      console.log(\"Error: \", error);\n    };\n  };\n\n  return (\n    <div\n      className={styles.popup}\n      onClick={(e) => {\n        if (e.target === e.currentTarget) {\n          onClose?.();\n        }\n      }}\n    >\n      <div className={styles.popup__content}>\n        <div className={styles.popup__close} onClick={onClose}>\n          <Icons.PopupClose />\n        </div>\n        <h3 className={styles.popup__title}>Аватар</h3>\n        <div\n          className={styles.image}\n          style={{\n            backgroundImage: `url(${currentFile || DefaultImage})`,\n          }}\n        >\n          <div className={styles.imageOverlay}>\n            <Button\n              className={styles.button_overlay}\n              clickHandler={(_) => {\n                fileInput.current.click();\n              }}\n            >\n              <Icons.AddAvatarIcon />\n            </Button>\n            {currentFile && (\n              <Button\n                className={styles.button_overlay}\n                clickHandler={() => {\n                  setCurrentFile(null);\n                  onChange(null);\n                  fileInput.current.value = \"\";\n                }}\n              >\n                <Icons.DeleteAvatarIcon />\n              </Button>\n            )}\n          </div>\n        </div>\n        <input\n          className={styles.fileInput}\n          type=\"file\"\n          ref={fileInput}\n          onChange={(e) => {\n            setError(\"\");\n            const file = e.target.files[0];\n            getBase64(file);\n          }}\n        />\n        {error && <p className={styles.error}>{error}</p>}\n        <p className={styles.info}>{`формат ${fileTypes.join(\n          \"/\"\n        )}, размер до ${fileSize}мб`}</p>\n        <Button className={styles.popup__button} clickHandler={onSubmit}>\n          Сохранить\n        </Button>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}