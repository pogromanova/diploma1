{"ast":null,"code":"import _objectSpread from\"/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _defineProperty from\"/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _slicedToArray from\"/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Card,Title,Pagination,CardList,Button,CheckboxGroup,Container,Main,Icons}from\"../../components\";import cn from\"classnames\";import styles from\"./styles.module.css\";import{useRecipes}from\"../../utils/index.js\";import{useEffect,useState,useContext}from\"react\";import api from\"../../api\";import{useParams,useHistory}from\"react-router-dom\";import{AuthContext,UserContext}from\"../../contexts\";import MetaTags from\"react-meta-tags\";import DefaultImage from\"../../images/userpic-icon.jpg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";var UserPage=function UserPage(_ref){var updateOrders=_ref.updateOrders;var _useRecipes=useRecipes(),recipes=_useRecipes.recipes,setRecipes=_useRecipes.setRecipes,recipesCount=_useRecipes.recipesCount,setRecipesCount=_useRecipes.setRecipesCount,recipesPage=_useRecipes.recipesPage,setRecipesPage=_useRecipes.setRecipesPage,handleLike=_useRecipes.handleLike,handleAddToCart=_useRecipes.handleAddToCart;var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),subscribed=_useState4[0],setSubscribed=_useState4[1];var history=useHistory();var userContext=useContext(UserContext);var authContext=useContext(AuthContext);var getRecipes=function getRecipes(_ref2){var _ref2$page=_ref2.page,page=_ref2$page===void 0?1:_ref2$page;api.getRecipes({page:page,author:id}).then(function(res){var results=res.results,count=res.count;setRecipes(results);setRecipesCount(count);});};var getUser=function getUser(){api.getUser({id:id}).then(function(res){setUser(res);setSubscribed(res.is_subscribed);}).catch(function(err){history.push(\"/not-found\");});};useEffect(function(_){if(!user){return;}getRecipes({page:recipesPage,author:user.id});},[recipesPage,user]);useEffect(function(_){getUser();},[]);return/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(Container,{className:styles.container,children:[/*#__PURE__*/_jsxs(MetaTags,{children:[/*#__PURE__*/_jsx(\"title\",{children:user?\"\".concat(user.first_name,\" \").concat(user.last_name):\"Страница пользователя\"}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:user?\"\\u0424\\u0443\\u0434\\u0433\\u0440\\u0430\\u043C - \".concat(user.first_name,\" \").concat(user.last_name):\"Фудграм - Страница пользователя\"}),/*#__PURE__*/_jsx(\"meta\",{property:\"og:title\",content:user?\"\".concat(user.first_name,\" \").concat(user.last_name):\"Страница пользователя\"})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.title,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.titleTextBox,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.user,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.userAvatar,style:{\"background-image\":\"url(\".concat(user&&user.avatar||DefaultImage,\")\")}}),/*#__PURE__*/_jsx(Title,{className:cn(_defineProperty({},styles.titleText,true)),title:user?\"\".concat(user.first_name,\" \").concat(user.last_name):\"\"})]}),(userContext||{}).id!==(user||{}).id&&authContext&&/*#__PURE__*/_jsxs(Button,{className:cn(styles.buttonSubscribe,_defineProperty({},styles.buttonSubscribeActive,subscribed)),modifier:subscribed?\"style_dark\":\"style_light\",clickHandler:function clickHandler(_){var method=subscribed?api.deleteSubscriptions.bind(api):api.subscribe.bind(api);method({author_id:id}).then(function(_){setSubscribed(!subscribed);});},children:[/*#__PURE__*/_jsx(Icons.AddUser,{}),\" \",subscribed?\"Отписаться от автора\":\"Подписаться на автора\"]})]})}),recipes.length>0&&/*#__PURE__*/_jsx(CardList,{children:recipes.map(function(card){return/*#__PURE__*/_createElement(Card,_objectSpread(_objectSpread({},card),{},{key:card.id,updateOrders:updateOrders,handleLike:handleLike,handleAddToCart:handleAddToCart}));})}),/*#__PURE__*/_jsx(Pagination,{count:recipesCount,limit:6,page:recipesPage,onPageChange:function onPageChange(page){return setRecipesPage(page);}})]})});};export default UserPage;","map":{"version":3,"names":["Card","Title","Pagination","CardList","Button","CheckboxGroup","Container","Main","Icons","cn","styles","useRecipes","useEffect","useState","useContext","api","useParams","useHistory","AuthContext","UserContext","MetaTags","DefaultImage","UserPage","updateOrders","recipes","setRecipes","recipesCount","setRecipesCount","recipesPage","setRecipesPage","handleLike","handleAddToCart","id","user","setUser","subscribed","setSubscribed","history","userContext","authContext","getRecipes","page","author","then","res","results","count","getUser","is_subscribed","catch","err","push","_","container","first_name","last_name","title","titleTextBox","userAvatar","avatar","titleText","buttonSubscribe","buttonSubscribeActive","method","deleteSubscriptions","bind","subscribe","author_id","length","map","card"],"sources":["/app/src/pages/user/index.js"],"sourcesContent":["import {\n  Card,\n  Title,\n  Pagination,\n  CardList,\n  Button,\n  CheckboxGroup,\n  Container,\n  Main,\n  Icons,\n} from \"../../components\";\nimport cn from \"classnames\";\nimport styles from \"./styles.module.css\";\nimport { useRecipes } from \"../../utils/index.js\";\nimport { useEffect, useState, useContext } from \"react\";\nimport api from \"../../api\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { AuthContext, UserContext } from \"../../contexts\";\nimport MetaTags from \"react-meta-tags\";\nimport DefaultImage from \"../../images/userpic-icon.jpg\";\n\nconst UserPage = ({ updateOrders }) => {\n  const {\n    recipes,\n    setRecipes,\n    recipesCount,\n    setRecipesCount,\n    recipesPage,\n    setRecipesPage,\n    handleLike,\n    handleAddToCart,\n  } = useRecipes();\n  const { id } = useParams();\n  const [user, setUser] = useState(null);\n  const [subscribed, setSubscribed] = useState(false);\n  const history = useHistory();\n  const userContext = useContext(UserContext);\n  const authContext = useContext(AuthContext);\n\n  const getRecipes = ({ page = 1 }) => {\n    api.getRecipes({ page, author: id }).then((res) => {\n      const { results, count } = res;\n      setRecipes(results);\n      setRecipesCount(count);\n    });\n  };\n\n  const getUser = () => {\n    api\n      .getUser({ id })\n      .then((res) => {\n        setUser(res);\n        setSubscribed(res.is_subscribed);\n      })\n      .catch((err) => {\n        history.push(\"/not-found\");\n      });\n  };\n\n  useEffect(\n    (_) => {\n      if (!user) {\n        return;\n      }\n      getRecipes({ page: recipesPage, author: user.id });\n    },\n    [recipesPage, user]\n  );\n\n  useEffect((_) => {\n    getUser();\n  }, []);\n\n  return (\n    <Main>\n      <Container className={styles.container}>\n        <MetaTags>\n          <title>\n            {user\n              ? `${user.first_name} ${user.last_name}`\n              : \"Страница пользователя\"}\n          </title>\n          <meta\n            name=\"description\"\n            content={\n              user\n                ? `Фудграм - ${user.first_name} ${user.last_name}`\n                : \"Фудграм - Страница пользователя\"\n            }\n          />\n          <meta\n            property=\"og:title\"\n            content={\n              user\n                ? `${user.first_name} ${user.last_name}`\n                : \"Страница пользователя\"\n            }\n          />\n        </MetaTags>\n        <div className={styles.title}>\n          <div className={styles.titleTextBox}>\n            <div className={styles.user}>\n              <div\n                className={styles.userAvatar}\n                style={{\n                  \"background-image\": `url(${\n                    (user && user.avatar) || DefaultImage\n                  })`,\n                }}\n              />\n              <Title\n                className={cn({\n                  [styles.titleText]: true,\n                })}\n                title={user ? `${user.first_name} ${user.last_name}` : \"\"}\n              />\n            </div>\n\n            {(userContext || {}).id !== (user || {}).id && authContext && (\n              <Button\n                className={cn(styles.buttonSubscribe, {\n                  [styles.buttonSubscribeActive]: subscribed,\n                })}\n                modifier={subscribed ? \"style_dark\" : \"style_light\"}\n                clickHandler={(_) => {\n                  const method = subscribed\n                    ? api.deleteSubscriptions.bind(api)\n                    : api.subscribe.bind(api);\n                  method({\n                    author_id: id,\n                  }).then((_) => {\n                    setSubscribed(!subscribed);\n                  });\n                }}\n              >\n                <Icons.AddUser />{\" \"}\n                {subscribed ? \"Отписаться от автора\" : \"Подписаться на автора\"}\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {recipes.length > 0 && (\n          <CardList>\n            {recipes.map((card) => (\n              <Card\n                {...card}\n                key={card.id}\n                updateOrders={updateOrders}\n                handleLike={handleLike}\n                handleAddToCart={handleAddToCart}\n              />\n            ))}\n          </CardList>\n        )}\n        <Pagination\n          count={recipesCount}\n          limit={6}\n          page={recipesPage}\n          onPageChange={(page) => setRecipesPage(page)}\n        />\n      </Container>\n    </Main>\n  );\n};\n\nexport default UserPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}