{"ast":null,"code":"import _slicedToArray from\"/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from\"./styles.module.css\";import{useContext,useEffect,useState}from\"react\";import{LinkComponent,Orders}from\"../index.js\";import{AuthContext,UserContext}from\"../../contexts\";import{UserMenu}from\"../../configs/navigation\";import Icons from\"../icons\";import DefaultImage from\"../../images/userpic-icon.jpg\";import{AvatarPopup}from\"../avatar-popup\";import api from\"../../api\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AccountData=function AccountData(_ref){var userContext=_ref.userContext,setIsChangeAvatarOpen=_ref.setIsChangeAvatarOpen;return/*#__PURE__*/_jsx(\"div\",{className:styles.accountProfile,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.accountData,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.accountName,children:[userContext.first_name,\" \",userContext.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:styles.accountEmail,children:userContext.email})]})});};var Account=function Account(_ref2){var onSignOut=_ref2.onSignOut,orders=_ref2.orders;var authContext=useContext(AuthContext);var userContext=useContext(UserContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isChangeAvatarOpen=_useState2[0],setIsChangeAvatarOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newAvatar=_useState4[0],setNewAvatar=_useState4[1];var handleSaveAvatar=function handleSaveAvatar(){if(newAvatar){api.changeAvatar({file:newAvatar}).then(function(_ref3){var avatar=_ref3.avatar;userContext.avatar=avatar;setIsChangeAvatarOpen(false);}).catch(function(err){return console.log(err);});}else{api.deleteAvatar().then(function(){userContext.avatar=\"\";setIsChangeAvatarOpen(false);}).catch(function(err){return console.log(err);});}};if(!authContext){return null;}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LinkComponent,{className:styles.accountOrders,href:\"/cart\",title:/*#__PURE__*/_jsx(Orders,{orders:orders})}),/*#__PURE__*/_jsx(\"div\",{style:{\"background-image\":\"url(\".concat(userContext.avatar||DefaultImage,\")\")},className:styles.accountAvatar,onClick:function onClick(){setIsChangeAvatarOpen(true);},children:/*#__PURE__*/_jsx(\"div\",{className:styles.imageOverlay,children:/*#__PURE__*/_jsx(Icons.AddAvatarIcon,{})})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.account,children:[/*#__PURE__*/_jsx(AccountData,{userContext:userContext,setIsChangeAvatarOpen:setIsChangeAvatarOpen}),/*#__PURE__*/_jsx(\"div\",{className:styles.accountControls,children:/*#__PURE__*/_jsxs(\"ul\",{className:styles.accountLinks,children:[UserMenu.map(function(menuItem){return/*#__PURE__*/_jsx(\"li\",{className:styles.accountLinkItem,children:/*#__PURE__*/_jsx(LinkComponent,{className:styles.accountLink,href:menuItem.href,title:/*#__PURE__*/_jsxs(\"div\",{className:styles.accountLinkTitle,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.accountLinkIcon,children:menuItem.icon}),menuItem.title]})})});}),/*#__PURE__*/_jsxs(\"li\",{className:styles.accountLinkItem,onClick:onSignOut,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.accountLinkIcon,children:/*#__PURE__*/_jsx(Icons.LogoutMenu,{})}),\"\\u0412\\u044B\\u0439\\u0442\\u0438\"]})]})})]}),isChangeAvatarOpen&&/*#__PURE__*/_jsx(AvatarPopup,{info:\"test\",avatar:userContext.avatar,onClose:function onClose(){return setIsChangeAvatarOpen(false);},onSubmit:handleSaveAvatar,onChange:setNewAvatar})]});};export default Account;","map":{"version":3,"names":["styles","useContext","useEffect","useState","LinkComponent","Orders","AuthContext","UserContext","UserMenu","Icons","DefaultImage","AvatarPopup","api","AccountData","userContext","setIsChangeAvatarOpen","accountProfile","accountData","accountName","first_name","last_name","accountEmail","email","Account","onSignOut","orders","authContext","isChangeAvatarOpen","newAvatar","setNewAvatar","handleSaveAvatar","changeAvatar","file","then","avatar","catch","err","console","log","deleteAvatar","accountOrders","accountAvatar","imageOverlay","account","accountControls","accountLinks","map","menuItem","accountLinkItem","accountLink","href","accountLinkTitle","accountLinkIcon","icon","title"],"sources":["/app/src/components/account/index.js"],"sourcesContent":["import styles from \"./styles.module.css\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { LinkComponent, Orders } from \"../index.js\";\nimport { AuthContext, UserContext } from \"../../contexts\";\nimport { UserMenu } from \"../../configs/navigation\";\nimport Icons from \"../icons\";\nimport DefaultImage from \"../../images/userpic-icon.jpg\";\nimport { AvatarPopup } from \"../avatar-popup\";\nimport api from \"../../api\";\n\nconst AccountData = ({ userContext, setIsChangeAvatarOpen }) => {\n  return (\n    <div className={styles.accountProfile}>\n      <div className={styles.accountData}>\n        <div className={styles.accountName}>\n          {userContext.first_name} {userContext.last_name}\n        </div>\n        <div className={styles.accountEmail}>{userContext.email}</div>\n      </div>\n    </div>\n  );\n};\n\nconst Account = ({ onSignOut, orders }) => {\n  const authContext = useContext(AuthContext);\n  const userContext = useContext(UserContext);\n  const [isChangeAvatarOpen, setIsChangeAvatarOpen] = useState(false);\n  const [newAvatar, setNewAvatar] = useState(\"\");\n\n  const handleSaveAvatar = () => {\n    if (newAvatar) {\n      api\n        .changeAvatar({ file: newAvatar })\n        .then(({ avatar }) => {\n          userContext.avatar = avatar;\n          setIsChangeAvatarOpen(false);\n        })\n        .catch((err) => console.log(err));\n    } else {\n      api\n        .deleteAvatar()\n        .then(() => {\n          userContext.avatar = \"\";\n          setIsChangeAvatarOpen(false);\n        })\n        .catch((err) => console.log(err));\n    }\n  };\n\n  if (!authContext) {\n    return null;\n  }\n\n  return (\n    <>\n      <LinkComponent\n        className={styles.accountOrders}\n        href=\"/cart\"\n        title={<Orders orders={orders} />}\n      />\n      <div\n        style={{\n          \"background-image\": `url(${userContext.avatar || DefaultImage})`,\n        }}\n        className={styles.accountAvatar}\n        onClick={() => {\n          setIsChangeAvatarOpen(true);\n        }}\n      >\n        <div className={styles.imageOverlay}>\n          <Icons.AddAvatarIcon />\n        </div>\n      </div>\n      <div className={styles.account}>\n        <AccountData\n          userContext={userContext}\n          setIsChangeAvatarOpen={setIsChangeAvatarOpen}\n        />\n\n        <div className={styles.accountControls}>\n          <ul className={styles.accountLinks}>\n            {UserMenu.map((menuItem) => {\n              return (\n                <li className={styles.accountLinkItem}>\n                  <LinkComponent\n                    className={styles.accountLink}\n                    href={menuItem.href}\n                    title={\n                      <div className={styles.accountLinkTitle}>\n                        <div className={styles.accountLinkIcon}>\n                          {menuItem.icon}\n                        </div>\n                        {menuItem.title}\n                      </div>\n                    }\n                  />\n                </li>\n              );\n            })}\n            <li className={styles.accountLinkItem} onClick={onSignOut}>\n              <div className={styles.accountLinkIcon}>\n                <Icons.LogoutMenu />\n              </div>\n              Выйти\n            </li>\n          </ul>\n        </div>\n      </div>\n      {isChangeAvatarOpen && (\n        <AvatarPopup\n          info=\"test\"\n          avatar={userContext.avatar}\n          onClose={() => setIsChangeAvatarOpen(false)}\n          onSubmit={handleSaveAvatar}\n          onChange={setNewAvatar}\n        />\n      )}\n    </>\n  );\n};\n\nexport default Account;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}